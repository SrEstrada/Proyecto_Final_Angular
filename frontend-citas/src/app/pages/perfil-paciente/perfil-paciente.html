<div class="container mt-4" *ngIf="perfil; else cargandoTpl">
    <h2 class="text-primary mb-4">Mi Perfil</h2>
  
    <!-- Datos del perfil -->
    <form (ngSubmit)="guardarPerfil()" #perfilForm="ngForm" class="mb-5">
      <div class="mb-3">
        <label class="form-label">Usuario</label>
        <input class="form-control" [value]="perfil.username" disabled>
      </div>
  
      <div class="mb-3">
        <label class="form-label">Correo</label>
        <input class="form-control" [(ngModel)]="perfil.email" name="email">
      </div>
  
      <div class="mb-3">
        <label class="form-label">Teléfono</label>
        <input class="form-control" [(ngModel)]="perfil.telefono" name="telefono">
      </div>
  
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Nombres</label>
          <input class="form-control" [(ngModel)]="perfil.first_name" name="first_name">
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Apellidos</label>
          <input class="form-control" [(ngModel)]="perfil.last_name" name="last_name">
        </div>
      </div>
  
      <button class="btn btn-primary" type="submit" [disabled]="guardando">
        {{ guardando ? 'Guardando...' : 'Guardar cambios' }}
      </button>
      <span class="ms-3" [class.text-success]="mensaje && !guardando">{{ mensaje }}</span>
    </form>
  
    <!-- Historial de Citas -->
    <h3 class="mb-3">Historial de Citas</h3>
    <div *ngIf="citas.length === 0" class="alert alert-info">No tienes citas registradas.</div>
  
    <div class="table-responsive" *ngIf="citas.length > 0">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Hora</th>
            <th>Médico</th>
            <th>Especialidad</th>
            <th>Estado</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let c of citas">
            <td>{{ c.fecha }}</td>
            <td>{{ c.hora }}</td>
            <td>{{ c.medico }}</td>
            <td>{{ c.especialidad }}</td>
            <td>{{ c.estado }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  
  <ng-template #cargandoTpl>
    <div class="container mt-4">
      <p>Cargando perfil...</p>
    </div>
  </ng-template>